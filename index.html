<html>
	<head>
		<title>CrimildJS Demo</title>
        <script data-main="src/crimild" src="lib/require.js"></script>
        <script id="shader-fs" type="x-shader/x-fragment">
        	precision mediump float;

            varying vec4 vColor;
        	
        	void main(void) {
        		gl_FragColor = vColor;
        	}
        </script>
        <script id="shader-vs" type="x-shader/x-vertex">
        	attribute vec3 aVertexPosition;
        	
        	uniform mat4 uMVMatrix;
        	uniform mat4 uPMatrix;

            varying vec4 vColor;
        	
        	void main(void) {
        		gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
                vColor = vec4(aVertexPosition, 1.0);
        	}
        </script>
		<script type="text/javascript">
			function initCrimild(canvasId) {
                require(["crimild"], function(crimild) {
                    var scene = crimild.core.groupNode({
                        name: "scene",
                        nodes: [
                            crimild.core.geometryNode({
                                name: "a cone",
                                primitives: [
                                    crimild.primitives.conePrimitive({
                                        type: crimild.core.primitive.types.TRIANGLES,
                                        vertexFormat: crimild.core.vertexFormat()
                                    })
                                ],
                                local: crimild.math.transformation({
                                    translate: [-1.5, 0, 0]
                                })
                            }),
                            crimild.core.geometryNode({
                                name: "a klein bottle",
                                primitives: [
                                    crimild.primitives.kleinBottlePrimitive({
                                        type: crimild.core.primitive.types.LINES,
                                        vertexFormat: crimild.core.vertexFormat()
                                    })
                                ],
                                local: crimild.math.transformation({
                                    translate: [1.5, 0, 0],
                                    scale: 0.15
                                })
                            })
                        ],
                        local: crimild.math.transformation({
                            translate: [0, 0, -5]
                        })
                    });

                    scene.renderComponent = crimild.rendering.renderComponent({
                        effects: [
                            crimild.rendering.effect({
                                shaderProgram: crimild.rendering.shaderProgram({
                                    vertexShader: crimild.rendering.shader({
                                        scriptId: "shader-vs"
                                    }),
                                    fragmentShader: crimild.rendering.shader({
                                        scriptId: "shader-fs"
                                    })
                                })
                            })
                        ]
                    });

                    var canvas = document.getElementById(canvasId);
                    crimild.simulation.run({canvas: canvas, scene: scene});
                });
			}
		</script>
	</head>
	<body onload="initCrimild('webGLCanvas');">
    	<div align="center">
            <h1>Crimild JS Demo</h1>
            <canvas id="webGLCanvas" style="border: none;" width="800" height="600">
    	       Your browser does not support WebGL
            </canvas>
        </div>
	</body>
</html>