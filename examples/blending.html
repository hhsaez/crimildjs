<!doctype html>
<html>
<head>
    <title>crimildjs</title>
    <script data-main="../src/crimild" src="../lib/require.js"></script>
    <script type="text/javascript">
        function initCrimild(canvasId) {
            require(["crimild"], function(crimild) {
                var assetManager = crimild.utils.assetManager();
                assetManager.queueImage("../examples/assets/earth.jpg");
                assetManager.loadAll(function() {
                    var canvas = document.getElementById(canvasId);
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;

                    var scene = crimild.core.groupNode({
                        name: "scene",
                        nodes: [
                            crimild.core.geometryNode({
                                name: "a cube",
                                primitives: [
                                    crimild.primitives.spherePrimitive({ 
                                        vertexFormat: crimild.core.vertexFormat({ positions: 3, textureCoords: 2 })
                                    }),
                                ],
                                components: [
                                    crimild.components.rotationComponent({angle: 0.01, axis: [0, 1, 0]}),
                                ]
                            }),
                            crimild.rendering.cameraNode({
                                aspectRatio: canvas.width / canvas.height,
                                local: crimild.math.transformation({
                                    translate: [0, 0, 4]
                                })
                            })
                        ],
                        components: [
                            crimild.rendering.renderComponent({
                                effects: [
                                    crimild.rendering.effect({
                                        textures: [
                                            crimild.rendering.texture({
                                                image: assetManager.getImage("../examples/assets/earth.jpg")
                                            })
                                        ],
                                        alphaState: crimild.rendering.alphaState({ 
                                            enabled: true,
                                            dstBlendFunc: crimild.rendering.alphaState.dstBlendFunc.ONE
                                        }),
                                        depthState: crimild.rendering.depthState({ enabled: false }),
                                        cullState: crimild.rendering.cullState({ enabled: false }),
                                    })
                                ]
                            })
                        ]
                    });

                    crimild.simulation.run({canvas: canvas, scenes: [scene]}).getRenderer().setClearColor([0, 0, 0, 1]);
                })
            });
        }
    </script>
</head>

<body onload="initCrimild('webGLCanvas');">
    <canvas id="webGLCanvas" style="margin: -8px; z-index: 0;" width="640" height="480">
        Your browser does not support WebGL
    </canvas>

    <div style="position: absolute; z-index: 1; left: 5px; top: 0px; float: left; color: white;">
        <p>This example uses blending to display a transparent sphere</p>
    </div>
</body>
</html>