<!DOCTYPE html>
<html>
	<head>
		<title>CrimildJS Example: Lightcycle</title>
	    <script type="text/javascript" src="../lib/jquery-1.9.0.js"></script>
	    <script type="text/javascript" src="../lib/jquery-ui-1.10.0.custom.min.js"></script>
		<script data-main="../src/crimild" src="../lib/require.js"></script>
		<link rel="stylesheet" type="text/css" href="../css/smoothness/jquery-ui-1.10.0.custom.min.css">
		<link rel="stylesheet" type="text/css" href="../css/example.css" />
		<script type="text/javascript">
			requirejs([
					"crimild", 
					"obj!../examples/assets/lightcycle/HQ_Movie_cycle.obj",
					"text!../shaders/glow.vert", "text!../shaders/glow.frag",
				], function(
					crimild, 
					objScene,
					glow_vs, glow_fs
				) {

				var canvas = $("#canvas").get(0);
				canvas.width = window.innerWidth;
				canvas.height = window.innerHeight;

				objScene.local.translate[1] -= 0.75;
				objScene.local.rotate = quat4.fromAngleAxis(-0.5 * Math.PI, [1, 0, 0]);

				crimild.run({
					scene: {
						_prototype: crimild.groupNode,
						nodes: [
							{
								_prototype: crimild.lightNode,
								local: {
									translate: [0, 0, 100]
								},
							},
							{
								_prototype: crimild.groupNode,
								nodes: [
									objScene
								],
								components: [
									{ 
										_prototype: crimild.trackpadComponent,
									}
								]
							},
							{
								_prototype: crimild.cameraNode,
								aspectRatio: (window.innerWidth / window.innerHeight),
								local: {
									translate: [0, 0, 3]
								},
								components: [
									{
										_prototype: crimild.effectComponent,
										effects: [
											{
												_prototype: crimild.effect,
												shaderProgram: {
													vertexShader: glow_vs,
													fragmentShader: glow_fs,
												},
												uniforms: [
												{ name: "uUseBloom", data: true }
												],
												update: function(time) {
													this.getUniform("uUseBloom").data = $("#glow").is(":checked");
												}
											}
										]
									}
								]
							}
						],
						components: [
						]
					},
					renderer: {
						canvas: canvas,
						clearColor: [0, 0, 0, 1]
					}
				});
			});
		</script>
	</head>
	<body>
        <canvas id="canvas">
            Your browser does not support WebGL
        </canvas>
		<div>
	        <div class="hud">
	            <p><a href="javascript:window.parent.location = '../index.html';">crimildjs</a> lightcycle</p>
	            <p><input type="checkbox" id="glow" /> glow<br/></p>
	        </div>
		</div>
	</body>
</html>

